 unsigned short crc = 0xFFFF;
    unsigned char i;

    while( len-- )
    {
        crc ^= *pcBlock << 8;
		*pcBlock++;
 
        for(i = 0; i < 8; i++)
		{
			if ((crc & 0x8000) != 0)
			{
				crc = ( crc << 1 ) ^ 0x1021;
			}
			else 
			{
				crc = crc << 1;
			}
		}
    }
 
    return crc;